# Multi-Agent Web Research System

This project implements a multi-agent system designed to perform web research based on a user's query and generate a synthesized report. It leverages multiple AI agents, external APIs, and asynchronous processing to achieve this.

## System Overview

![System Workflow](AgenticWorkflow.png)  
*Caption: Overview of the multi-agent research process*

### Process Steps

1. **User Query**: The process starts with the main research task provided by the user.
2. **Planning Agent**: This agent takes the task, analyzes it (understanding intent, constraints like dates), and breaks it down into several specific Sub-Queries.
3. **Concurrent Research Loop**: This is the core workhorse. For each Sub-Query generated by the planner:
   - **Search**: Tavily is used to find relevant web page URLs for that specific Sub-Query.
   - **Scrape**: Firecrawl (with rate limiting) attempts to retrieve the content from those URLs as clean Markdown. If scraping fails (due to website blocks, rate limits, errors), an Error Note is generated instead.
   - **Summarize**: The successful Markdown (or an error note) is passed to the Researcher LLM. This LLM generates a concise Focused Summary based only on information relevant to the original task or passes along the error note.
4. **Findings Block**: The output for each Sub-Query is a self-contained block containing either the relevant summaries or notes about errors encountered for that sub-topic.
5. **Aggregate Findings**: All the individual "Findings Blocks" from the concurrent research loops are collected together.
6. **Reporting Agent**: This agent takes the complete set of aggregated findings and the original user task. It uses a powerful Reporter LLM to:
   - Synthesize: Combine information logically.
   - Structure: Organize the content into a coherent report.
   - Address Task: Ensure the report directly answers the original query.
   - Handle Errors: Acknowledge sources where information couldn't be retrieved.
   - Generate: Produce the final text.
7. **Final Report / Error**: The system outputs the complete, synthesized report or a final error message if the reporting stage itself failed.

## Core Capabilities

- **Query Analysis**: Understands user query intent and decomposes complex questions.
- **Web Search**: Uses Tavily API to find relevant URLs for sub-queries.
- **Content Extraction**: Employs Firecrawl API for robust scraping of web content, returning Markdown.
- **Information Summarization**: Uses an LLM via OpenRouter to summarize scraped content, focusing on relevance.
- **Concurrent Processing**: Researches multiple sub-queries in parallel for efficiency.
- **Information Synthesis**: Combines findings from all sub-queries.
- **Report Generation**: Uses a powerful LLM via OpenRouter to create a structured, coherent report.
- **Error Handling**: Manages issues like API errors, rate limits, scraping failures, and LLM response problems.

## Technology Stack

- **Python 3.9+** (with asyncio)
- **LLM Interaction**: OpenRouter API (via `openai` library)
- **Web Search**: Tavily API (`tavily-python`)
- **Web Scraping**: Firecrawl API (`firecrawl-py`)
- **Configuration**: `python-dotenv`, `pydantic-settings`
- **Dependencies**: `json_repair`, `logging`

## Setup Instructions

1. **Clone the Repository**:
   ```bash
   git clone <your-repo-url>
   cd <your-repo-name>  # e.g., web-research-agent
   ```

2. **Create Virtual Environment (Recommended)**:
   ```bash
   python -m venv .venv
   # Activate:
   # Windows: .\.venv\Scripts\activate
   # MacOS/Linux: source .venv/bin/activate
   ```

3. **Install Dependencies**:
   ```bash
   pip install -r requirements.txt
   ```
   Ensure `requirements.txt` includes all packages listed in the Technology Stack section.

4. **Configure API Keys**:
   - Create a file named `.env` in the root project directory (`web-research-agent/`).
   - Add your API keys and optional settings:
     ```dotenv
     # --- Required ---
     OPENROUTER_API_KEY="sk-or-v1-..."  # Your OpenRouter API Key
     TAVILY_API_KEY="tvly-..."         # Your Tavily Search API Key
     FIRECRAWL_API_KEY="fc-..."        # Your Firecrawl API Key

     # --- Optional - Recommended for OpenRouter ---
     YOUR_SITE_URL="http://localhost:8000"  # Or your app identifier
     YOUR_APP_NAME="MyResearchAgent"        # Or your app name

     # --- Optional - LLM Models (Use OpenRouter model identifiers) ---
     # OPENROUTER_MODEL_PLANNER="openai/gpt-4o"
     # OPENROUTER_MODEL_RESEARCHER="openai/gpt-3.5-turbo"
     # OPENROUTER_MODEL_REPORTER="openai/gpt-4o"

     # --- Optional - Other Settings ---
     # MAX_SUB_QUERIES=5
     # MAX_SEARCH_RESULTS_PER_QUERY=5
     # MAX_SCRAPE_CONCURRENCY=2  # Keep low for free tiers initially
     ```
   - **IMPORTANT**: Add `.env` to your `.gitignore` file to prevent committing secrets.

## Running the Agent

Execute the main script from the command line within the project's root directory (`web-research-agent/`), providing the research query as an argument:

```bash
python main.py "Your research query goes here"
```

### Examples:
```bash
python main.py "What are the latest advancements in solid-state battery technology?"
python main.py "Compare the economic impacts of tourism in Italy vs Spain."
python main.py "How does climate change affect coffee production?"
```

The agent will log its progress (Planning, Researching, Reporting) to the console and print the generated report.

## Example Output

Below is an example report generated by the system, taken from `results/result2.md`:

```markdown
# Analysis of Renewable Energy Trends in Europe (2020-2023)

## Executive Summary

This report analyzes the recent trends in renewable energy adoption across Europe from 2020 to 2023. The research indicates significant growth in renewable energy capacity, with solar and wind power leading the expansion. Policy initiatives, particularly the European Green Deal and REPowerEU, have accelerated adoption rates, while technological advancements have reduced costs. However, challenges including grid integration issues, supply chain constraints, and regional disparities persist. Looking forward, Europe is positioned to continue its renewable energy transition with increasing investment, though policy consistency and infrastructure development remain critical factors for success.

## Key Findings

### Growth and Adoption Rates

- **Record Solar Expansion**: The EU added 41.4 GW of solar capacity in 2022, a 47% increase from 2021, with projections showing this growth trend continuing through 2023.
- **Wind Power Development**: Offshore wind capacity in Europe reached 28.4 GW by the end of 2021, and continued to grow in 2022-2023, though at a slower pace than solar.
- **Market Leadership**: Germany, Spain, Poland, the Netherlands, and France were the top five markets for new solar installations in 2022.
- **COVID-19 Impact and Recovery**: Despite initial setbacks during the pandemic, renewable energy was the only energy source to show growth during this period, demonstrating resilience in the sector.

### Policy Influences

- **European Green Deal**: This landmark policy framework, with its target of carbon neutrality by 2050, has been instrumental in driving renewable energy adoption across the EU.
- **REPowerEU**: Launched in May 2022 in response to the energy crisis exacerbated by the Russia-Ukraine conflict, this initiative aims to rapidly reduce dependence on Russian fossil fuels and accelerate the green transition.
- **National Incentives**: Various member states have implemented successful support schemes, including feed-in tariffs, tax incentives, and renewable energy auctions, which have stimulated market growth.

### Technological Advances

- **Cost Reductions**: The levelized cost of electricity (LCOE) for solar PV and wind has continued to decrease, making renewables more economically competitive with fossil fuels.
- **Efficiency Improvements**: Solar panel efficiency has increased, with commercial modules now regularly exceeding 22% efficiency, while wind turbines have grown larger and more efficient.
- **Storage Solutions**: Battery technology advancements have improved the viability of renewable energy, with Europe's battery storage capacity growing significantly between 2020 and 2023.
- **Green Hydrogen**: Investment in green hydrogen production using renewable electricity has gained momentum, with several major projects launched during this period.

### Investment Patterns

- **Increasing Capital Flow**: Investment in European renewable energy reached â‚¬29.6 billion in 2022, primarily directed toward solar and wind projects.
- **Corporate Procurement**: Corporate Power Purchase Agreements (PPAs) for renewable energy have grown substantially, with tech companies leading in procurement.
- **Public Funding**: The EU's Recovery and Resilience Facility has allocated substantial funds to green energy projects as part of the post-COVID economic recovery.

### Challenges and Barriers

- **Grid Integration**: Managing intermittency and ensuring grid stability remains challenging as renewable penetration increases.
- **Permitting Delays**: Lengthy administrative procedures continue to hinder faster deployment of renewable projects across many EU countries.
- **Supply Chain Constraints**: Dependencies on imported components, particularly from China, have created vulnerabilities in the supply chain.
- **Regional Disparities**: Eastern and Southern European countries generally lag behind Northern and Western Europe in renewable energy adoption rates and infrastructure.

## Regional Highlights

### Northern Europe
Nordic countries continue to lead in renewable energy integration, with Sweden and Finland achieving some of the highest shares of renewables in their energy mix. Denmark has made remarkable progress in wind energy, occasionally producing more electricity from wind than the country's total consumption.

### Western Europe
Germany remains Europe's largest renewable energy market, with significant expansion in both solar and wind capacity. France has accelerated its renewable deployment, particularly in solar, while facing challenges in meeting its nuclear energy transition goals.

### Southern Europe
Spain and Italy have experienced strong growth in solar installations, leveraging their favorable climate conditions. Portugal achieved multiple periods where renewable energy supplied 100% of its electricity demand during 2021-2023.

### Eastern Europe
Poland has emerged as one of the fastest-growing solar markets in Europe, though coal still dominates its energy mix. Hungary, Romania, and Bulgaria have shown improved renewable adoption rates, albeit from a lower baseline.

## Future Outlook

- **Accelerated Growth Trajectory**: The EU is on track to exceed its 2030 target of 40% renewables in the energy mix, with recent projections suggesting a share of approximately 45% may be achievable.
- **Sector Integration**: Increasing focus on electrification of transport and heating sectors will drive further renewable energy demand.
- **Technological Innovation**: Floating offshore wind, building-integrated photovoltaics, and advanced bioenergy are expected to gain market share.
- **Energy Communities**: Local energy initiatives and citizen-owned renewable projects are projected to become more prominent in the European energy landscape.
- **Policy Development**: The continued evolution of the EU Emissions Trading System and potential carbon border adjustment mechanisms will likely further incentivize renewable energy adoption.

## Conclusion

The period from 2020 to 2023 has been transformative for renewable energy in Europe, with unprecedented growth despite global challenges including the COVID-19 pandemic and energy market volatility. Solar and wind power have firmly established themselves as mainstream energy sources, no longer peripheral alternatives. The combination of supportive policies, technological improvements, and economic factors has created favorable conditions for continued expansion.

However, to maintain this momentum, Europe must address infrastructure limitations, streamline permitting processes, and ensure a just transition that benefits all regions and social groups. The coming years will be critical in determining whether Europe can leverage its current advantages to cement its position as a global leader in renewable energy and achieve its ambitious climate goals.

---

*Note: This report synthesizes information from multiple sources across the web as of October 2023. Some recent developments may not be reflected in this analysis.*
```

For additional examples, see the complete results directory in the repository.
